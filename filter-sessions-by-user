#!/bin/bash
#
# This script filters a stream of iRODS sessions for those generated by a given client.
#
# Usage: filter-sessions-by-user user
#
# PARAMETERS:
#  user: The iRODS username to filter on


main()
{
  local user="$1"

  awk --assign user="$user" --file - <(cat) <<'  }'
    BEGIN {
      RS = "ยง";
      FS = "โข";
    }

    $2 ~ "cuser=" user {
      printf "%s%s", RS, $0;
    }
  }
}


main "$@"
